<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha256-xejo6yLi6vGtAjcMIsY8BHdKsLg7QynVlFMzdQgUuy8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.12.3","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="organicCola&#39;s House">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="organicCola&#39;s House">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="organicCola">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>organicCola's House</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">organicCola's House</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Organic cola is good for your happiness</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">organicCola</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/23/Serve-a-local-file-with-download-link/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/23/Serve-a-local-file-with-download-link/" class="post-title-link" itemprop="url">Serve a local file with download link</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-23 02:58:06" itemprop="dateCreated datePublished" datetime="2022-09-23T02:58:06+08:00">2022-09-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Pre"><a href="#Pre" class="headerlink" title="Pre"></a>Pre</h1><p>想要在blog中提供一个文件下载连接，通常做法是将文件储存在一个三方平台，然后在blog中插入这个连接<br>但是如果文件本身不大，有时候我们也是希望将文件本身存在hexo的文件库里然后来引用的。</p>
<h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><h3 id="其实可以参考引用本地图片的方法"><a href="#其实可以参考引用本地图片的方法" class="headerlink" title="其实可以参考引用本地图片的方法"></a>其实可以参考引用本地图片的方法</h3><p>在source文件夹下存在一个imgs文件夹，里面又一个pic.png 我想引用它就这么写<br><code>![pic](../imgs/pic.png)</code></p>
<p>于是我在source下再新建一个files文件夹，并在里面新建一个test.txt<br>这样引用<br><code>[test](../files/test.txt)</code></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/17/Using-Charles-debugging-through-Socks/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/17/Using-Charles-debugging-through-Socks/" class="post-title-link" itemprop="url">Using Charles debugging through Socks</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-17 19:15:39" itemprop="dateCreated datePublished" datetime="2022-09-17T19:15:39+08:00">2022-09-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Pre"><a href="#Pre" class="headerlink" title="Pre"></a>Pre</h3><p>Charles 除了经典的通过http执行代理debug之外还可以使用sock，两种方式的区别可以看Charles官方的说明，而实际使用中明显的区别就是有些http下遇到的无法抓包情况socks下可以正常执行。</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><h4 id="1-使用iOS自带的代理"><a href="#1-使用iOS自带的代理" class="headerlink" title="1. 使用iOS自带的代理"></a>1. 使用iOS自带的代理</h4><p>  使用iOS wifi 自带的代理设置一般只能设置http类型<br>  如果想要socks类型可以使用自动代理，可以利用自动代理模式</p>
<h5 id="1-1-自建Pac文件"><a href="#1-1-自建Pac文件" class="headerlink" title="1. 1. 自建Pac文件"></a>1. 1. 自建Pac文件</h5>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">charles_socks.pac</span><br><span class="line">function FindProxyForURL(url, host) &#123; return &#x27;SOCKS 192.168.199.105:8881; SOCKS5 192.168.199.105:8881&#x27;; &#125;</span><br></pre></td></tr></table></figure>
<h5 id="1-2-本地启动一个服务器来提供pac文件"><a href="#1-2-本地启动一个服务器来提供pac文件" class="headerlink" title="1. 2. 本地启动一个服务器来提供pac文件"></a>1. 2. 本地启动一个服务器来提供pac文件</h5>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd pathToPacFile</span><br><span class="line">python -m SimpleHTTPServer </span><br></pre></td></tr></table></figure>
<h5 id="1-3-在wifi代理里面选半自动代理，填入pac文件地址"><a href="#1-3-在wifi代理里面选半自动代理，填入pac文件地址" class="headerlink" title="1. 3. 在wifi代理里面选半自动代理，填入pac文件地址"></a>1. 3. 在wifi代理里面选半自动代理，填入pac文件地址</h5><p>  <code>http://127.0.0.1:8000/pathToPacFile</code><br>  但是经测试如果这个socks使用时仍有问题，他跟http一样会在某些时候卡住无法继续，也许是iOS自带的socks支持程度与charles的不同。</p>
<h4 id="2-使用Socks-Proxy-Client"><a href="#2-使用Socks-Proxy-Client" class="headerlink" title="2. 使用Socks Proxy Client"></a>2. 使用Socks Proxy Client</h4><p>  目前发现的能提供正常可用的sock5连接iOS客户端有以下几个，当然这些国区AppStore都没有。<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ShadowRocket(paid)</span><br><span class="line">Surge(paid)</span><br><span class="line">Brook(a free &amp; open-source one)</span><br></pre></td></tr></table></figure></p>
<p><a href="../files/test" title="C源码下载">点击下载</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/16/sheep-hack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/16/sheep-hack/" class="post-title-link" itemprop="url">Sheep_hack 羊了个羊速通</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-16 06:15:36" itemprop="dateCreated datePublished" datetime="2022-09-16T06:15:36+08:00">2022-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Pre"><a href="#Pre" class="headerlink" title="Pre"></a>Pre</h3><p>一个魔性三消微信小程序游戏。由于游戏第二关是真随机，导致很难通关。既然制作者不讲武德也别怪玩家不客气。</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>通过抓包可以看到为数不多的请求里有个很扎眼的map_id，是关卡地图，于是可以从rewrite request入手，把所有关卡的地图全变成第一关最简单的地图。</p>
<h3 id="Several-solution"><a href="#Several-solution" class="headerlink" title="Several solution"></a>Several solution</h3><blockquote>
<table>
<thead>
<tr>
<th>Solution 1</th>
<th>Desktop + iOS device</th>
</tr>
</thead>
<tbody><tr>
<td>Desktop</td>
<td>DebuggingProxyTool(Charles&#x2F;Fidder…)</td>
</tr>
<tr>
<td>iOS device</td>
<td>ProxyTool supporting Socks(Brook&#x2F;Surge&#x2F;ShadowRocket&#x2F;Quantumult…)</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<p>or</p>
</blockquote>
<blockquote>
<table>
<thead>
<tr>
<th>Solution 2</th>
<th>iOS Traffic Sniffer App with rewrite function</th>
</tr>
</thead>
<tbody><tr>
<td>iOS device</td>
<td>Http Cacher&#x2F;Storm Sniffer&#x2F;Surge&#x2F;Thor…</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<p> 安卓没有试，但理论上方法一样。安装证书Charles证书之后，通过wifi连接Charles，有可能会遇到SSL Pinning导致https无法抓取，解决办法是Android上安装Xposed+JustTrustMe来绕过SSL Pinning</p>
</blockquote>
<h4 id="Cost"><a href="#Cost" class="headerlink" title="Cost"></a>Cost</h4><table>
<thead>
<tr>
<th>Mac Proxy App</th>
<th>Price</th>
</tr>
</thead>
<tbody><tr>
<td>Charles</td>
<td>不注册也可以免费试用, 有免费注册方法，sniff，rewirte全功能可用</td>
</tr>
</tbody></table>
<p>proxy app 国区没有幸存者</p>
<table>
<thead>
<tr>
<th>iOS Proxy App</th>
<th>Price</th>
</tr>
</thead>
<tbody><tr>
<td>Brook</td>
<td>freeCharge(国区没有)</td>
</tr>
<tr>
<td>Surge</td>
<td>freeDownload，抓包免费 proxy rewrite内购，(国区没有)</td>
</tr>
<tr>
<td>ShadowRocket</td>
<td>paid(国区没有)</td>
</tr>
<tr>
<td>Quantumult</td>
<td>paid(国区没有)</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>iOS on-deivce Sniffer App</th>
<th>Price</th>
</tr>
</thead>
<tbody><tr>
<td>HttpCacher</td>
<td>freeDownload，http抓包免费，https抓包内购，rewrite内购</td>
</tr>
<tr>
<td>StormSniffer</td>
<td>freeDownload，http抓包免费，https抓包内购，rewrite 需要内购</td>
</tr>
<tr>
<td>Surge</td>
<td>freeDownload，抓包免费，proxy rewrite内购(国区没有)</td>
</tr>
<tr>
<td>Thor</td>
<td>paid，(似乎现在appStore搜不到)</td>
</tr>
</tbody></table>
<p>推荐 Charles + Brook 免费组合<br>我用的Charles + ShadowRocket 因为我刚好有</p>
<h3 id="Step"><a href="#Step" class="headerlink" title="Step"></a>Step</h3><ol>
<li><p>使用Charles在桌面端开启代理注意要使用SocksProxy (菜单栏 -&gt; Proxy -&gt; ProxySetting)<br><img src="/../imgs/Charles_proxy.png" alt="Charles_proxy"></p>
</li>
<li><p>按照Charles的提示安装CA证书在你的手机上。（菜单栏 Help -&gt; SSL Proxying -&gt; Install Charles Root Certification on a Mobile Device or Remote Browser)</p>
</li>
<li><p>iOS使用ShadowRocket添加Charles的代理，注意类型填socks类型，这里ip如果不知道填什么可以在Charles里查看(菜单栏 -&gt; Help -&gt; Local IP Address)。代理要设置为全局代理。<br><img src="/../imgs/ShadowRocket_add_SocksProxy.jpeg" alt="ShadowRocket_add_SocksProxy"></p>
</li>
<li><p>打开Charles的rewrite功能，url’s parameter, key map_id 的 value 不用填，自动全部替换统一改为 80001 (菜单栏 -&gt; Tools -&gt; rewrite)<br><img src="/../imgs/Charles_rewrite_setting.png" alt="Charles_rewrite_setting"></p>
</li>
<li><p>(Optional)接下来按顺序操作，验证是否操作成功，不过此时如果顺利直接进游戏也可以。</p>
<blockquote>
<ol>
<li>删除微信里羊了个羊</li>
<li>打开Charles的Recoring (菜单栏 -&gt; Proxy -&gt; Start Recoring)</li>
<li>Charles中点击Clear Session(菜单栏 -&gt; File -&gt; Clear Session)</li>
<li>再进入羊了个羊，一直进入到第一关</li>
<li>检查左侧是否出现了红框里的数据，如果所有的id都是80001，恭喜你，成功了。<br>如果不行可能是检查步骤出错，回到第一步重新操作；如果多次不行则前面设置代理有问题，返回检查。<br><img src="/../imgs/Charles_verify_result.png" alt="Charles_verify_result"></li>
</ol>
</blockquote>
</li>
<li><p>进游戏过了第一关之后来到第二关，但是第二关也变成了第一关的模样，15秒速通。</p>
</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/05/A-simple-solution-to-do-Privacy-Diary-Sync/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/05/A-simple-solution-to-do-Privacy-Diary-Sync/" class="post-title-link" itemprop="url">一种朴素的私密文件同步方案 A simple solution to do Privacy Diary Sync</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-05 01:04:05" itemprop="dateCreated datePublished" datetime="2022-09-05T01:04:05+08:00">2022-09-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Pre"><a href="#Pre" class="headerlink" title="Pre"></a>Pre</h3><p>现在可能还有人写日记。。。或者不算日记，但是是一些私密的东西，不想让人看的东西。</p>
<h3 id="Issue"><a href="#Issue" class="headerlink" title="Issue"></a>Issue</h3><p>不想让人看很简单，你只写在本地就行了。<br>但是一般你不会只在一个设备上记录，有可能还会在别的设备上记录或查看，于是涉及到了同步。<br>隐私内容的同步是个问题，不过无非几种方式:</p>
<blockquote>
<ul>
<li>云上中心化的存储方式:各大云盘，各大app，搭建服务器存储。<br>缺点是传到网上内容就由不得你了，尽管所有笔记都声称自己加密了用户数据，也保证不会偷窥用户隐私，但是这种保障等于空气。至于搭建的服务器，机器是服务商提供的，仍然没有办法保证服务商不偷窥我们的内容。即使没有偷窥问题，如果服务器被攻击了隐私就会暴露。</li>
<li>本地文件同步方案。由于没有上云，隐私安全性有所提高。<blockquote>
<p>p2p: 通过Syncthing一类的同步软件，进行同步。不过本地p2p需要一个常驻的在线设备。不过p2p的粗暴有可能会遇到多设备同时修改造成冲突的问题。<br>git: 本地自建git server，可以很好地解决多设备修改冲突的问题。不过也同样需要git server常驻在线。<br>如果不采用随时地可以同步的方法，就可以不需要常驻在线设备，只在需要同步的时候进行同步。不过这样需要不能随时随地备份最新的数据，总是感觉有点不放心。</p>
</blockquote>
</li>
</ul>
</blockquote>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>其实对比两种方案，本质的区别也就是同步范围的区别。一个是通过更多人能接触的中心服务器，一个是限制范围只在本地小范围内同步。如果可以结合云上同步的便捷与本地同步的隐私就好了。</p>
<h5 id="压缩加密文件"><a href="#压缩加密文件" class="headerlink" title="压缩加密文件"></a>压缩加密文件</h5><p>其实早就有了一种简单朴素的保护文件隐私的办法，那就是文件加密，相信其实有不少人都是这么做的。<br>我想这个方法虽然简单，但是其实经过上面的分析后却会发现这其实是一个很好的，简单又实用的方法。<br>于是文件的隐私通过对文件加密折中实现。<br>一种经典方法便是压缩文件并加上密码保护, zip&#x2F;rar等。<br>于是，将文件加密并上传至云，并在各个设备间同步，似乎是一个不错的选择。</p>
<h5 id="使用非对称加密"><a href="#使用非对称加密" class="headerlink" title="使用非对称加密"></a>使用非对称加密</h5><p>zip等压缩加密办法使用的是对称加密，通常面临暴力破解的问题，当然你也可以通过增加密码的复杂度来提升安全性。除了对称加密外还有非对称加密可以选择，ecc&#x2F;rsa都可以。目前来看理论上只要你的密钥不外泄，加密文件是十分安全的。</p>
<h3 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h3><p>推荐一个工具 GnuPG<br>其实加解密只是GPG的一个用途，其主要用途是用于用于身份认证，并提供了密钥管理。</p>
<blockquote>
<a href="/2022/09/04/An-introduction-to-GnuPG/" title="An introduction to GnuPG">An introduction to GnuPG</a>
</blockquote>
<h3 id="使用流程"><a href="#使用流程" class="headerlink" title="使用流程"></a>使用流程</h3><p>将文件压缩，并对其进行加密，上传至云。同步至设备时再反向操作解密解压文件。<br>不过有个问题要注意，就是因为加密的缘故，git对它也不适用了，因为会被当作二进制文件。针对这个问题可以在文件夹内部建一个内部git用于控制，压缩加密时连同.git文件夹一起打包加密，这样就既可以使用git控制版本，又不影响加密了。<br>如此就可以完美和之前的笔记方法融合在一起。</p>
<blockquote>
<a href="/2022/07/02/A-basic-enough-solution-to-organize-GTD-dailyNOtes/" title="一种朴素的几乎纯文本笔记和GTD方案 - A basic enough solution to organize GTD and dailyNotes">一种朴素的几乎纯文本笔记和GTD方案 - A basic enough solution to organize GTD and dailyNotes</a>
</blockquote>
<h4 id="Diagram"><a href="#Diagram" class="headerlink" title="Diagram"></a>Diagram</h4><pre><code class="highlight mermaid">flowchart LR;

subgraph A[Client A]
  F((Privacy File with Built-in Git)) --&gt; |Zip| Z(zipped file);
  subgraph GPG[GnuPG]
    Z --&gt; E[[Encrypted File]]
    P(Public key) --&gt; |encrypt with Public Key| E
  end
end

subgraph B[Client B]
  subgraph GPGa[GnuPG]
    Ea[[Encrypted File]] --&gt; Za
    S(Secret key) --&gt; |decrypt with Secret Key| Za;
  end
  Za(zipped file) --&gt; |Unzip| Fa((Privacy File with Built-in Git))
end

A &lt;-.-&gt; |Sync| G;
G[(Git repository)];
G &lt;-.-&gt; |Sync| B;</code></pre>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/04/An-introduction-to-GnuPG/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/04/An-introduction-to-GnuPG/" class="post-title-link" itemprop="url">An introduction to GnuPG</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-04 05:50:45" itemprop="dateCreated datePublished" datetime="2022-09-04T05:50:45+08:00">2022-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="G-nu-pg"><a href="#G-nu-pg" class="headerlink" title="G(nu)pg"></a>G(nu)pg</h3><p>PGP vs GPG<br>PGP 是最早先的加密商业软件<br>一般现在提起PGP是指PGP协议<br>G(nu)pg is for Gnu Privacy Guard<br>GPG是GNU下的PGP实现</p>
<h3 id="GPG采用主私钥-若干子密钥设计"><a href="#GPG采用主私钥-若干子密钥设计" class="headerlink" title="GPG采用主私钥 + 若干子密钥设计"></a>GPG采用主私钥 + 若干子密钥设计</h3><p>平时一般使用子密钥来进行具体操作。主密钥只用来进行签发新的子密钥，或对密钥进行修改。可以认为主密钥是你在网上的主要身份凭证，如果因此要保护好，一般因为泄漏或者丢失而不得不对其进行revoke将会使你失去身份。所以在所有设置都正常的情况下，日常使用不需要用到Primary key，应该将其保存在一个安全的地方，隔离与电脑的设备，甚至是纸张。</p>
<h3 id="一些常见缩写含义"><a href="#一些常见缩写含义" class="headerlink" title="一些常见缩写含义"></a>一些常见缩写含义</h3><h5 id="密钥能力"><a href="#密钥能力" class="headerlink" title="密钥能力"></a>密钥能力</h5><table>
<thead>
<tr>
<th>Abb</th>
<th>Ability</th>
</tr>
</thead>
<tbody><tr>
<td>[C]</td>
<td>Certifitating 认证，用于签发子密钥</td>
</tr>
<tr>
<td>[S]</td>
<td>Signing 签名</td>
</tr>
<tr>
<td>[E]</td>
<td>Encrypting 加密</td>
</tr>
<tr>
<td>[A]</td>
<td>Authenticating 身份验证</td>
</tr>
</tbody></table>
<h5 id="密钥缩写含义"><a href="#密钥缩写含义" class="headerlink" title="密钥缩写含义"></a>密钥缩写含义</h5><table>
<thead>
<tr>
<th>Abb</th>
<th>Explain</th>
</tr>
</thead>
<tbody><tr>
<td><strong>pub</strong></td>
<td>Public Key</td>
</tr>
<tr>
<td><strong>sec</strong></td>
<td>Secret Key</td>
</tr>
<tr>
<td><strong>sub</strong></td>
<td>Public SubKey</td>
</tr>
<tr>
<td><strong>ssb</strong></td>
<td>Secret Subkey</td>
</tr>
</tbody></table>
<h3 id="一些命令"><a href="#一些命令" class="headerlink" title="一些命令"></a>一些命令</h3><h5 id="生成主密钥"><a href="#生成主密钥" class="headerlink" title="生成主密钥"></a>生成主密钥</h5><p><code>gpg --gen-key</code></p>
<h5 id="本地密钥保护密码"><a href="#本地密钥保护密码" class="headerlink" title="本地密钥保护密码"></a>本地密钥保护密码</h5><p>生成密钥时会同时让你设定一个用于保护本地密钥的密码，每个主密钥的保护密码是相互独立的，在不同设备上密码是独立，也就是说这个密钥是gpg的本地设置，与钥匙串无关，所以在你修改了密码手动save的话，系统会告诉你钥匙串没有更新，没有save的必要。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpg --edit-key userId</span><br><span class="line">&gt; passwd</span><br></pre></td></tr></table></figure>

<h5 id="list-keys"><a href="#list-keys" class="headerlink" title="list keys"></a>list keys</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gpg --list-keys (简写 -k)</span><br><span class="line">gpg --list-serect-keys (简写 -K)</span><br><span class="line">gpg -k --keyid-format long  (显示sub keyid)</span><br><span class="line">gpg -k --fingerprint (指纹)</span><br></pre></td></tr></table></figure>

<h5 id="edit-key-撤销密钥-x2F-修改密钥有效期-x2F-删除密钥"><a href="#edit-key-撤销密钥-x2F-修改密钥有效期-x2F-删除密钥" class="headerlink" title="edit key 撤销密钥&#x2F;修改密钥有效期&#x2F;删除密钥"></a>edit key 撤销密钥&#x2F;修改密钥有效期&#x2F;删除密钥</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gpg --edit-key --keyid-format long uid (进入edit交互)</span><br><span class="line">&gt; key 1 选择第(1)个subkey（不选择key会默认对整个primary key所包含的所有key进行操作)</span><br><span class="line">&gt; key 2 选择第(2)个subkey</span><br><span class="line">&gt; expire 将会对key1 / key2 (进行过期日期设置)</span><br><span class="line">&gt; revkey 吊销key1 / key2 (已经revoke的key仍然可以加解密，他只是一个标记，告诉你使用这个的人已经不会再继续使用它)</span><br><span class="line">&gt; delkey (删除key1 / key2)</span><br><span class="line">&gt; save (不保存修改无法生效)</span><br></pre></td></tr></table></figure>
<h5 id="uid编辑"><a href="#uid编辑" class="headerlink" title="uid编辑"></a>uid编辑</h5><p>修改uid，uid只作为你的信息，对加密没有影响。uid只能添加，和删除，不能修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gpg --edit-key</span><br><span class="line">&gt; adduid 新增按提示操作</span><br><span class="line">&gt; uid 1 （与key类似，uid 1 表示选中了uid 1</span><br><span class="line">&gt; deluid 删除uid</span><br></pre></td></tr></table></figure>

<h5 id="导出密钥"><a href="#导出密钥" class="headerlink" title="导出密钥"></a>导出密钥</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpg -ao public-key.txt --export &lt;UserId&gt;</span><br><span class="line">gpg -ao encrypt-subkey --export-secret-subkeys &lt;keyId&gt;</span><br></pre></td></tr></table></figure>
<p>注意，在keyId后面加上!可以强指定此id而不会全部导出子密钥。</p>
<h5 id="删除密钥-按userID删除key-不进入交互"><a href="#删除密钥-按userID删除key-不进入交互" class="headerlink" title="删除密钥 按userID删除key(不进入交互)"></a>删除密钥 按userID删除key(不进入交互)</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpg --delete-secret-keys &lt;UserId&gt;  # 删除私钥，UID 也可以替换成子密钥ID, 主密钥Key ID</span><br><span class="line">gpg --delete-keys &lt;UserId&gt;  # 删除公钥	</span><br></pre></td></tr></table></figure>

<h5 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h5><p>对称加解密，不带密码缓存，每次都输入的方法<br><code>gpg -c --no-symkey-cache test.txt.gpg</code><br>非对称加密<br>-r 参数 指定接受者id 会使用这个id下的一个公钥来加密，需要对方有这个公钥对应的密钥才能解密。<br><code>gpg -e -r uesrId test.txt</code></p>
<h5 id="修改私钥读取提示需要密码的时间（秒）"><a href="#修改私钥读取提示需要密码的时间（秒）" class="headerlink" title="修改私钥读取提示需要密码的时间（秒）"></a>修改私钥读取提示需要密码的时间（秒）</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/.gnupg/gpg-agent.conf</span><br><span class="line">default-cache-ttl 600</span><br><span class="line">max-cache-ttl 7200</span><br></pre></td></tr></table></figure>

<h3 id="一些解释"><a href="#一些解释" class="headerlink" title="一些解释"></a>一些解释</h3><h5 id="revoke和delte的区别"><a href="#revoke和delte的区别" class="headerlink" title="revoke和delte的区别"></a>revoke和delte的区别</h5><p>revoke相当于打上吊销标记，delete才是删除。<br>revoke还有个作用就是通过send-key到key-server，让keyserver同步状态来声明revoke</p>
<h5 id="Expire"><a href="#Expire" class="headerlink" title="Expire"></a>Expire</h5><p>已经过期的key仍然可以解密。但是不能进行新的加密，会给你过期的提示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; gpg: CF12434DC!: skipped: Unusable public key</span><br><span class="line">&gt; gpg: test.txt: encryption failed: Unusable public key</span><br></pre></td></tr></table></figure>
<p>但是我们随时可以设置密钥的有效期，所以即使过期了想继续用的话重新设置有效期即可。其实过期日期主要还是声名给通讯的对方来知晓的，如果只是单机使用直接设个永不过期也无所谓。</p>
<h5 id="对于revoke-解释"><a href="#对于revoke-解释" class="headerlink" title="对于revoke 解释"></a>对于revoke 解释</h5><p>由于pgp是针对传输的加密，对于密钥丢失&#x2F;泄漏的情况，一般流程是，用户revoke密钥后作出声名,上传revoke过后的key到key server，大家更新之后之后就会知道此key已经revoke，接下来不会再继续使用。但是你不能控制用户是否去更新你的key设置。如果用户没有去更新，然后删掉这个公钥，那么他手上的公钥依然可以解密已revoke的key之前加密过的文件。</p>
<h5 id="关于密钥指定"><a href="#关于密钥指定" class="headerlink" title="关于密钥指定"></a>关于密钥指定</h5><p>在GPG中密钥一般是由系统自动选择的，比如根据你填写的UserId或者当前要进行的动作(Sign&#x2F;Ecrypt)来自动选择名下最新的一个公钥来进行加密。不过也可以在keyId后加上!来强制指定，当你有多个key时这个做法很有效。<br><code>gpg -e -r CF12434DC! test.txt</code></p>
<h3 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h3><h5 id="一些想法"><a href="#一些想法" class="headerlink" title="一些想法"></a>一些想法</h5><p>其实非对称加密比较适用于通信加密，只要文件在远离密钥的地方，目前来说几乎是不可解密的；但是假如攻击者获取了存有密钥的设备，对于本地文件的加密，就只剩下本地对于密钥的对称加密保护这一道防线了。这时候就需要一个强密码保护，但是强密码保护很难用人脑记住，肯定存放于某个保存密钥的app甚至是文件内，而这个app的保护密码设定又是一个难题，肯定是人脑能记住的，相对容易输入的，相对不太复杂，这种密码被攻破的概率也很大。<br>如果能随时更改这个密码的话就好了，于是想到一个方案：在一个云端存放子密钥，每端在想要加解密gpg文件前下载gpg子密钥，使用完之后删除。这样，如果设备遗失了第一时间删除网络上的子密钥，设备上的内容就无法读取了。前提是攻击者不会提前知道这个网址，不过提前知道的概率不大，因为只有进入了设备才能知道，网址的存在，但是一旦设备遗失我们已经将网址内的密钥清除了。<br>其实除了算法加密，通过改变加密流程，加密思路，乃至社工的办法，都是算是一种加密，只要能保护文件内容的方法就是好方法。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/08/11/dingxiang-suspend/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/08/11/dingxiang-suspend/" class="post-title-link" itemprop="url">丁香医生账号被禁言</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-08-11 01:28:40" itemprop="dateCreated datePublished" datetime="2022-08-11T01:28:40+08:00">2022-08-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/memo/" itemprop="url" rel="index"><span itemprop="name">memo</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>晚上才发现了这个事情。<br>具体为何原因被封没有给出官方解释，民间猜测归为“回形针”一类帽子。<br>一些为此发声的公众号文章也被禁了。  </p>
</blockquote>
<p><strong>抢救存档了两个发声文章。</strong>  <em>（需科</em></p>
<ul>
<li><strong><a target="_blank" rel="noopener" href="https://archive.ph/aTr9L"><code>这些年，丁香医生都做了什么🔗</code></a></strong></li>
<li><strong><a target="_blank" rel="noopener" href="https://archive.ph/A6teJ"><code>丁香飘零🔗</code></a></strong></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/02/A-basic-enough-solution-to-organize-GTD-dailyNOtes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/07/02/A-basic-enough-solution-to-organize-GTD-dailyNOtes/" class="post-title-link" itemprop="url">一种朴素的几乎纯文本笔记和GTD方案 - A basic enough solution to organize GTD and dailyNotes</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-07-02 06:49:31" itemprop="dateCreated datePublished" datetime="2022-07-02T06:49:31+08:00">2022-07-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>现在人不写日记了（正经人谁写日记，你写吗？）<br>但是好记性不如烂笔头， 工作生活免不了要写写笔记备忘录之类的。</p>
</blockquote>
<h3 id="Pre"><a href="#Pre" class="headerlink" title="Pre"></a>Pre</h3><h5 id="现状-Situation"><a href="#现状-Situation" class="headerlink" title="现状 Situation:"></a>现状 Situation:</h5><p>很长一段时间我的笔记都处在一种自由生长的状态，电脑和手机都会用到，使用不同软件不同方法，各成体系，之间几乎不能同步。</p>
<blockquote>
<ul>
<li>电脑端：一组txt文本记录Notes，处在git控制之下，使用vim编辑；todo list也都以PlainText形式记录在这些文本中，做完手动更改状态。</li>
<li>手机端：使用iOS自带的备忘录，做todo list，几乎不会写笔记，有也是塞进todo list里面。</li>
</ul>
</blockquote>
<h5 id="存在问题-Issue"><a href="#存在问题-Issue" class="headerlink" title="存在问题 Issue:"></a>存在问题 Issue:</h5><blockquote>
<ul>
<li>一个早就有的痛点：不同平台无法同步，同步只能通过Apple的备忘录手动复制粘贴。</li>
<li>有数据丢失风险，有时候网络不佳，刚写完的备忘录会在iCloud上同步失败，一条todo直接消失不见。</li>
<li>手机上todo和电脑端的数据格式不同，这是也无法同步的原因之一，另一个是缺少同步手段。</li>
</ul>
</blockquote>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><h4 id="分析-Analysis"><a href="#分析-Analysis" class="headerlink" title="分析 Analysis:"></a>分析 Analysis:</h4><blockquote>
<ul>
<li>不能同步的原因是不同平台间的内容储存和管理方式不同</li>
<li>手机端用的是iOS自带的软件，数据被限制在app中，iCloud平台也不够通用，而且限制在Apple生态中</li>
<li>电脑端用的是文本文件。</li>
<li>数据稳定性受网络影响，并且手机端同步的状态只能通过肉眼查看内容来确认状态，没有一个显式的状态。</li>
</ul>
</blockquote>
<h4 id="大纲-Requirments"><a href="#大纲-Requirments" class="headerlink" title="大纲 Requirments:"></a>大纲 Requirments:</h4><p>整理一下问题，现在可以大体罗列一下需求。</p>
<ul>
<li>需要最大程度解决兼容性问题，使用文本文件为中心 <code>txt/md</code><blockquote>
<ul>
<li>不能寻求一个All in one的app，以防锁死在其中，失去支持，不能导出数据，或者导出的数据很难处理与其他应用不兼容。</li>
<li>不应该以任何App为中心来进行构建，因为你无法保证每个app之间能良好通信，共享数据。</li>
<li>应该以一种最为基础的内容为中心。</li>
<li>需要一种最基础简单的数据形式: 文本，最简单的即是TXT文本文件，相信它的兼容性是无可比拟的。笔记的本质是信息，而文字是一种高效率信息记录方式，小小的1M都蕴含着海量信息；图表为辅。</li>
<li>txt文件的兼容性可以保证最大程度上在各种设备、应用中储存，打开，阅读。</li>
</ul>
</blockquote>
</li>
<li>需要一种最安全的储存&#x2F;同步方式：<code>git/syncthing(p2p)</code><blockquote>
<ul>
<li>需要可以在本地编辑。</li>
<li>需要可以云端储存</li>
<li>最好可以进行版本控制</li>
</ul>
</blockquote>
</li>
<li>对文件进行编辑，基于文本文件使用各种工具增强体验 <code>各种工具和应用</code><blockquote>
<ul>
<li>使用趁手的编辑器&#x2F;应用</li>
<li>最好是可以支持md</li>
<li>最好是可以用Vim</li>
<li>最好是有一种基于简单格式文本的但有方便互动操作的GTD方案</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="RelationShip-Diagram"><a href="#RelationShip-Diagram" class="headerlink" title="RelationShip Diagram"></a>RelationShip Diagram</h3><pre><code class="highlight mermaid">flowchart TB;

subgraph Mac[Mac local]
  F([Txt/Md/Org Files on Mac]) --- T;
  subgraph R[Review/Edit]
    V(Vim on iTerm)
    E(Emacs: todo-list)
  end
  R --- T; 
  T(iTerm)
  G((Git in iTerm))
  T --- G;
end
G &lt;-.-&gt;|Sync| Gc;
Gc &lt;-.-&gt;|Sync| Gi;
Gc[(Git remote repository)]

subgraph iOS[iOS local]
  A([Txt/Md/Org Files in iOS Files]) --- Fi;
  Fi(iOS Files app) --- I;
  I(iSH)
  subgraph Ri[Review/Edit]
    Vi(iVim on iOS) 
    B(beOrg: todo-list)
    O(Obsidian on iOS)
  end
  Ri --- Fi;
  I --- Gi;
  Gi((Git in iSH))
end
</code></pre>
<h3 id="工具-Tools"><a href="#工具-Tools" class="headerlink" title="工具 Tools"></a>工具 Tools</h3><p>这些工具都是免费的或免费版也已经够用的，大多数是开源的</p>
<ul>
<li><p>电脑端：</p>
<blockquote>
<ul>
<li>环境：Cli <code>iTerm</code></li>
<li>同步：<code>git</code></li>
<li>编辑：<code>Vim</code>&#x2F;<code>Emacs</code>(用于todo-list)</li>
</ul>
</blockquote>
</li>
<li><p>移动端(iOS) </p>
<blockquote>
<ul>
<li>同步：git(in iSH)<br><del>iOS端因为封闭的文件系统要在app间共享文件和使用git比较麻烦，iOS上的git app最知名的有Working Copy，不过想要连接Working Copy以外其他App的文件夹和全部git功能都需要Pro订阅，弃之。</del><br>然后发现了一个神器iSH。iSH内运行alpine linux，可以安装一个完整的git，和电脑端的别无二至。因为直接是linux环境，运行脚本，修改alias这些不在话下，用起来甚至比GUI的WorkingCopy更方便。<br>对于连接iSH文件夹以外的位置，iSH可以通过mount命令做到。<br><code>mount -t ios-unsafe . /root/mountFolder/</code><br>注意这里最好写ios-unsafe，否则使用git的时候可能会经常进行index并且非常慢。<br>并且注意因为alpine是单线程的，在iOS下使用可能会有问题，解决方法是<code>git</code>的<code>.gitconfig</code>文件里加上  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[pack]</span><br><span class="line">    threads = 1</span><br></pre></td></tr></table></figure></li>
<li>编辑&#x2F;阅读：<code>iVim</code>&#x2F;<code>Obsidian</code>&#x2F;<code>beOrg</code>(用于todo-list)<br>iVim：在键盘上方添加了一些常用符号，操作起来虽然没有真键盘方便但是比原键盘舒服多了。<br>Obsidian：移动端屏幕比较小，直接在终端里操作并不方便，还是需要Obsidian这种能够渲染md文件的app来进行阅读比较舒适，其实也有别的md渲染app，为什么选Obsidian？并不是因为他有双向连接什么的，只是紫色黑曜石的icon比较好看～ 事实上电脑上我也并不会使用Obsidian，笔记&#x2F;todo&#x2F;代码 终端一把梭。<br>beOrg：可以识别你的Emacs Org文件，todo-list，也可以使用agenda，因为没有键盘，在移动端还是这种GUI更方便，点选就可以改变state、deadline和新建todo。文本格式和Emacs兼容的还行，偶尔会有多少一两行空行啥的，问题不大。</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><ol>
<li>以文本文件为内容核心 <blockquote>
<p>使用md文件和org文件作为memo和todo list。特点是完全text-based，md和org的特点决定了他们即使不通过任何特定工具，任何平台上都可以以文本文件的形式查看，并且很直观，没有复杂的格式，但是又具有扩展性，可以做更复杂的展示、图表统计等。</p>
</blockquote>
</li>
<li>通过git&#x2F;syncthing等同步工具做全平台同步，<blockquote>
<p>而git的同步储存、版本管理能力无需多言，通过git自然而然地又满足了多备份异地备份，抗灾能力强，还可以通过自建本地私有git服务来实现完全信息私有。</p>
</blockquote>
</li>
<li>外围可以使用工具来增强体验。<blockquote>
<p>使用beorg、obsidia之类的工具增强阅读和交互编辑体验在手机上简单的点选todi-list，obsidian可以建关系图。同时文件text-based的特性让你可以用你自己最喜欢的编辑器来编辑，比如vim，typora，emacs，vscode等。</p>
</blockquote>
</li>
</ol>
<p><em>缺点</em>：<br>要说简单肯定是不如notion&#x2F;飞书这种一站式方便，也有一些工具上的使用成本。<br><strong>优点</strong>：<br>总的来说文本文件系统是最通用基础的管理方式，能保证极大的兼容性，与各种特定的软件之间解耦，但又能广泛地通过软件加强其能力。长远看可以把控其中细节，其中的细节可以拆分，便于拓展替换，与特定软件解耦。<br>试想当你所有笔记都在All-in在app中，某天你发现某个功能无法满足你的要求需要使用其他软件来配合，却发现该软件很难与其他app互动，因为他们数据格式不能互通。。。又或者某天他忽然挂了，网络卡住，或软件本身卡住，你却无法查看其中内容，或者你想转移数据却发现只有付费Pro版才能这么做，转出来了却发现内容根本不可读。。。又或者他数据根本不提供本地导出，你所有的数据都以一种你无法读取无法触及的方式存在一个遥远的服务器上，然后陷入深深的绝望。。。</p>
<h3 id="这时候你才想起来，你本可以对自己的数据更有掌握权的。"><a href="#这时候你才想起来，你本可以对自己的数据更有掌握权的。" class="headerlink" title="这时候你才想起来，你本可以对自己的数据更有掌握权的。"></a>这时候你才想起来，你本可以对自己的数据更有掌握权的。</h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/19/Using-git-with-ssh-throuhgh-proxy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/02/19/Using-git-with-ssh-throuhgh-proxy/" class="post-title-link" itemprop="url">Using git with ssh throuhgh proxy</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-02-19 03:56:51" itemprop="dateCreated datePublished" datetime="2022-02-19T03:56:51+08:00">2022-02-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Pre"><a href="#Pre" class="headerlink" title="Pre"></a>Pre</h3><p>一般平时的环境可以直连国际万维网，所以没有什么问题。但某天在家中使用git时，虽然开着ClashX，却发现速度还是龟速，忍不了了，遂着手解决一下。</p>
<h3 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h3><p><a href="#02-19-Solution"><code>Solution🚀</code></a></p>
<h3 id="TroubleShooting"><a href="#TroubleShooting" class="headerlink" title="TroubleShooting"></a>TroubleShooting</h3><h4 id="首先是看一下，检查一下全局的代理值"><a href="#首先是看一下，检查一下全局的代理值" class="headerlink" title="首先是看一下，检查一下全局的代理值"></a>首先是看一下，检查一下全局的代理值</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$https_proxy</span></span></span><br><span class="line">http://127.0.0.1:7890</span><br></pre></td></tr></table></figure>
<p>心中一惊，这意味着全局的代理是正常的，然而速度还是慢，说明原因还没找到，need to go deeper…</p>
<h4 id="检查-gitconfig文件"><a href="#检查-gitconfig文件" class="headerlink" title="检查.gitconfig文件"></a>检查<code>.gitconfig</code>文件</h4><p><code>git config --global -e</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[http]</span><br><span class="line">	sslBackend = openssl</span><br><span class="line">	proxy = http://127.0.0.1:7890</span><br><span class="line">[https]</span><br><span class="line">	proxy = http://127.0.0.1:7890</span><br><span class="line">[socks5]</span><br><span class="line">	proxy = socks5://127.0.0.1:7890</span><br></pre></td></tr></table></figure>
<p>所有的设置也都正常，按理说只要全局设置了git自动就会走代理，但是现在两个都设置了还不行。<br>忽然想到会不会问题不在git设置，而是在clash？</p>
<h4 id="查看ClashX的Connections"><a href="#查看ClashX的Connections" class="headerlink" title="查看ClashX的Connections"></a>查看<code>ClashX</code>的<code>Connections</code></h4><p>打开ClashX dashboard 查看 <code>Connections</code> 一栏。当我使用git clone 来进行测试时，发现里面居然找不到git的相关连接。<br>到这里为止可算是找到了一点蛛丝马迹，但这只是表象，具体问题现在还不知道，不过猜测可能是网站不在Clash的规则里面？于是查找了规则名单，一些大型的git托管网站都在里面，所以问题不在这里。</p>
<h4 id="ssh的锅"><a href="#ssh的锅" class="headerlink" title="ssh的锅"></a>ssh的锅</h4><p>搞来搞去还是不行，想吐。但这时候我忽然想起来，会不会是ssh的锅？<br>于是git clone一个https形式的repository。发现Clash <code>Connections</code>中出现了连接，到这里算是确定了问题所在。</p>
<a id="02-19-Solution"/>

<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>首先想到的是我直接使用https形式的地址不就行了吗，但是忽然发现bitbucket似乎不支持https的地址，至少是需要支持ssh形式的。于是放弃奇技淫巧，还是走正道。本来https也不够方便，还有可能要时不时输个密码。<br>于是网上搜索一番，ssh走代理的方式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~/.ssh/config</span><br><span class="line"></span><br><span class="line">Host bitbucket.org</span><br><span class="line">  Hostname ssh.bitbucket.org</span><br><span class="line">  Port 22</span><br><span class="line">  ProxyCommand nc -v -x 127.0.0.1:7890 %h %p</span><br></pre></td></tr></table></figure>
<p>nc 也就是网上所说的“瑞士军刀”netcat<br>再次执行git clone 测试，丝滑～</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> **************************</span></span><br><span class="line">Connection to ssh.bitbucket.com port 22 [tcp/ssh] succeeded!</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h3><p>注意终端里各个程序不一定都会走全局代理，这个ssh就是典型，需要看具体应用的代理方式是如何设置的。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/08/06/coding-iOS-Vim/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/08/06/coding-iOS-Vim/" class="post-title-link" itemprop="url">Use Vim for iOS project development</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-08-06 21:58:30" itemprop="dateCreated datePublished" datetime="2021-08-06T21:58:30+08:00">2021-08-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="iOS-project-Editor"><a href="#iOS-project-Editor" class="headerlink" title="iOS project Editor"></a>iOS project Editor</h2><p>一般对于iOS开发者来说Xcode是进行开发的首选工具，这也是苹果官方的开发工具。<br>如果是非专职iOS开发者，那么也有极大的概率使用着其他开发工具。比如写flutter或者rn这种非native app，则可能会直接使用VSCode；对于native app除了vscode也有其他选择，比如jetBrains家的App Code，已经做的非常好，甚至集成了CocoaPods，不过AppCode貌似是收费的。<br>如果你是Vim爱好者，那么很容易在Xcode以外的这些工具中找到Vim插件，体验不错，常用的功能都有。<br>对于Xcode官方也已经在Xcode13中提供了Vim keybind支持，不过很基础，一些常用的功能体面没有提供，使用使用体验与原生Vim存在差距。  </p>
<h2 id="Language-Server-Protocol"><a href="#Language-Server-Protocol" class="headerlink" title="Language Server Protocol"></a>Language Server Protocol</h2><p>其实现阶段在类似sublime、vscode、Emacs中跨行编辑代码并不是难事，多亏了微软主导的<a target="_blank" rel="noopener" href="https://langserver.org/">Language Server Protocol</a>，每个语言的开发者据此协议提供自己语言服务器以对外提供接口，然后编辑器只需要遵循这个协议即可轻松实现对各种语言的对接，编辑器只需要做好自己的使用体验，界面，输入优化等。</p>
<pre><code class="highlight mermaid">graph TD;
S(Swift) --&gt; D;
A(Java) --&gt; D;
B(JavaScript) --&gt; D;
C(C/C++) --&gt; D;
D(Language Server Protocol) --&gt; E(Vim);
D --&gt; F(Sublime);
D --&gt; G(VSCode);
D --&gt; H(Emacs);</code></pre>
<h2 id="Use-Vim-for-iOS-project-development"><a href="#Use-Vim-for-iOS-project-development" class="headerlink" title="Use Vim for iOS project development"></a>Use Vim for iOS project development</h2><p>而本文要讨论的则是一个更加朴素的环境，终端中的Vim，在终端中使用Vim来进行iOS工程的编写。<br>虽说是终端编写，但并不是说不需要Xcode了，Vim中做的只是编辑代码，仍需要使用Xcode来进行编译和运行以及Debug。<br>最终达成的效果是，用Xcode新建一个工程，编译，生成编译日志并将其解析为可供lsp-server使用的数据，在Vim中调用lsp-server提供自动补全、定义跳转等支持，在Vim中进行代码编写。</p>
<pre><code class="highlight mermaid">graph TD;
A(XcodeCompile/Debug)--&gt; |compile| B;

subgraph prepare info for Language Server
B(compile log)-.-&gt; |Objective-C| X;
B(compile log)--&gt; |Swift| Xa;
X(xcpretty/XCCompilationDB process) -.-&gt; |compile_commands.json| L;
Xa(Xcode Build Server process) --&gt; |.compile| L;
end

subgraph Vim-lsp&lt;=&gt;Language server Interactive
L((Vim-lsp)) -.- |json-compilation-database| Cl(Clangd);
L --- |Build Server Protocol| S(Sourcekit);
end

L === |LSP support: autoCompleteion/goToDefinition...| C;
C((Coding In Vim));</code></pre>
<h2 id="A-simple-Screencast"><a href="#A-simple-Screencast" class="headerlink" title="A simple Screencast"></a>A simple Screencast</h2><script id="asciicast-jVh32tJK83zPuX3wZjR3MoVLL" src="https://asciinema.org/a/jVh32tJK83zPuX3wZjR3MoVLL.js" async></script>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/07/01/Mermaid-display-adaption/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="organicCola">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="organicCola's House">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | organicCola's House">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/07/01/Mermaid-display-adaption/" class="post-title-link" itemprop="url">Mermaid display adaption</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-07-01 15:40:06" itemprop="dateCreated datePublished" datetime="2021-07-01T15:40:06+08:00">2021-07-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">technology</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Pre"><a href="#Pre" class="headerlink" title="Pre"></a>Pre</h3><p>Mermaid语法简单，使用方便，但是对具体布局的调整比较难以把控，在一些专业画图软件里的布局在mermaid里也难以实习。只能遵循一些规则尽量让布局符合我们的预期。</p>
<h3 id="关于mermaid布局"><a href="#关于mermaid布局" class="headerlink" title="关于mermaid布局"></a>关于mermaid布局</h3><ol>
<li>尽量使用TB而不是TD，TD不一定能按照top&#x2F;bottom排列</li>
<li>flowchart 支持嵌套&#x2F; graph 不支持嵌套subgraph</li>
<li>代码顺序不影响拓扑关系，但是有可能会影响布局。</li>
<li>flowchart TB 支持 subgpaph direction BT，而graph TB不支持</li>
<li>mermaid 中只要是相邻元素的连线方向会尽量保持与主方向。虽然拓扑不受影响，但是布局会受影响的，必须时刻注意，否则被强行调整元素位置可能会生成非期望的布局；未与外界直接相连的subgraph内的元素，可以通过direction控制方向。</li>
<li>注意元素之间在没有连线的情况下，默认与主轴交错防抢排列，并且默认顺序与添加语句顺序是颠倒的，最后添加的排在最前面；</li>
<li>mermaid连线时可能会强行调整元素位置，目前发现以下一些原则：</li>
</ol>
<ul>
<li>会将流程靠前的元素放到主轴方向的开端</li>
<li>位置靠前的元素以及其内部元素更不容易被调整位置</li>
<li>会尽量调整元素布局以使得连线最短</li>
</ul>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">```mermaid</span><br><span class="line">flowchart　TB</span><br><span class="line">subgraph a[Right]</span><br><span class="line">  direction TB</span><br><span class="line">  A&#x27; --&gt; B&#x27; --&gt; C&#x27; --&gt; D&#x27; --&gt; A&#x27;</span><br><span class="line">end</span><br><span class="line">subgraph b[Left]</span><br><span class="line">  direction TB</span><br><span class="line">  A --&gt; B --&gt; C --&gt; D</span><br><span class="line">end</span><br><span class="line">A&#x27; --&gt; D</span><br><span class="line">A --&gt; D&#x27;</span><br><span class="line">```</span><br></pre></td></tr></table></figure>

<pre><code class="highlight mermaid">flowchart　TB
subgraph a[Right]
  direction TB
  A&#x27; --&gt; B&#x27; --&gt; C&#x27; --&gt; D&#x27; --&gt; A&#x27;
end
subgraph b[Left]
  direction TB
  A --&gt; B --&gt; C --&gt; D
end
A&#x27; --&gt; D
A --&gt; D&#x27;</code></pre>

<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><ul>
<li>由于a的布局位置考后，更容易被调整位置，并且其内部是首尾相接的结构，允许其调整元素顺序而拓扑结构不变，为了使A –&gt; D’ 连线尽量短，会把D’调整位置到顶端，所以看起来元素顺序有点不符合预期。</li>
<li>subgraph a 和 subgraph b 如果交换代码位置，subgraph a 由于代码位置靠后，所以布局靠前，更不易被调整位置，所以abcd按照主轴方向依次向下排列，这样看起来顺眼多了。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">```mermaid</span><br><span class="line">flowchart　TB</span><br><span class="line">subgraph b[Left]</span><br><span class="line">  direction TB</span><br><span class="line">  A --&gt; B --&gt; C --&gt; D</span><br><span class="line">end</span><br><span class="line">subgraph a[Right]</span><br><span class="line">  direction TB</span><br><span class="line">  A&#x27; --&gt; B&#x27; --&gt; C&#x27; --&gt; D&#x27; --&gt; A&#x27;</span><br><span class="line">end</span><br><span class="line">A&#x27; --&gt; D</span><br><span class="line">A --&gt; D&#x27;</span><br><span class="line">```</span><br></pre></td></tr></table></figure>

<pre><code class="highlight mermaid">flowchart　TB
subgraph b[Left]
  direction TB
  A --&gt; B --&gt; C --&gt; D
end
subgraph a[Right]
  direction TB
  A&#x27; --&gt; B&#x27; --&gt; C&#x27; --&gt; D&#x27; --&gt; A&#x27;
end
A&#x27; --&gt; D
A --&gt; D&#x27;</code></pre>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">organicCola</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"neutral","dark":"default"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.3/mermaid.min.js","integrity":"sha256-TIYL00Rhw/8WaoUhYTLX9SKIEFdXxg+yMWSLVUbhiLg="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>



  





</body>
</html>
